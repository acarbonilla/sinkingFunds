{% extends 'base.html' %}
{% load mathfilters %}
{% block content %}

<h1> Manager's View</h1>
<div class="container">
    <div class="row">
        <div class="col-sm-4">
            <ol class="list-group list-group-numbered">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Contribution</div>
                        Total Number Of Contribution
                    </div>
                    <span class="badge bg-primary rounded-pill">{{contribCount}}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Contribution Amount</div>
                        Total Amount of Contribution
                    </div>
                    <span class="badge bg-primary rounded-pill">{{contribAmount}}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Reserved Amount</div>
                        Reserved Amount is 10%
                    </div>
                    <span class="badge bg-primary rounded-pill">{{reservedAmount}}</span>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Loanable Amount</div>
                        Available amount that can be loan.
                    </div>
                    <span class="badge bg-primary rounded-pill">{{loanableAmount}}</span>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Repayment Amount</div>
                        Amount that borrower's not paid
                    </div>
                    <span class="badge bg-primary rounded-pill">{{remAmounts}}</span>
                </li>
            </ol>
        </div>
        <div class="col-sm-8 border">
            <h3>Loan Application</h3>
            <hr>
            <table class="table table-hover">
                <thead>
                <tr>
                    <th scope="col">Loan ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Amount</th>
                    <th scope="col">Date Applied</th>
                    <th scope="col">Date Resolve</th>
                    <th scope="col">Loan Status</th>
                </tr>
                </thead>
                {% for lgLists in lgList %}
                    <tbody>
                        <tr>
                            {% if lgLists.status == "Pending" %}
                                    <td>{{lgLists.id}}</td>
                                    <td>{{lgLists.requestor.fName}} {{lgLists.requestor.lName}}</td>
                                    <td>{{lgLists.desiredAmount}}</td>
                                    <td>{{lgLists.dateApplied | timesince}}</td>
                                    <td>{{lgLists.dateDecision}}</td>
                                     <td>{{lgLists.status}}</td>
                                    <td>
                                         <a class="btn btn-secondary" href="{% url 'memberLoanTemplateEdit' lgLists.id %}">
                                             Checking
                                         </a>
                                    </td>
                            {% else %}

                            {% endif %}

                        </tr>
                    </tbody>
                {% endfor %}
            </table>

        </div>
    </div>
    <br/>
    <div class="row">
        <div class="col-sm-4">
            <ul class="list-group">
                <li class="list-group-item active" aria-current="true">Member having outstanding balance.</li>
                {% for payment in paymentGroup%}
                    {% if payment.loanAccount__desiredAmount|sub:payment.gcount != 0 %}
                        <li class="list-group-item">{{payment.loanAccount__requestor__fName}}
                            {{payment.loanAccount__requestor__lName}} -
                            {{payment.loanAccount__desiredAmount|sub:payment.gcount}}
                            / ({{payment.loanAccount__id}})
                        </li>
                    {% else %}

                    {% endif %}
                {% endfor %}
            </ul>
        </div>
        <div class="col-sm-8 border">
            <h3>Payment</h3>
            <hr>

            <table class="table table-hover">
                <thead>
                <tr>
                    <th scope="col">Loan ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Loan Amount</th>
                    <th scope="col">Paid Loan</th>
                    <th scope="col">Balanced</th>
                </tr>
                </thead>
                {% for payment in paymentGroup%}
                <tbody>
                <tr>
                    {% if payment.loanAccount__desiredAmount|sub:payment.gcount == 0%}
                    {% else %}
                        <td>{{payment.loanAccount__id}}</td>
                        <td>{{payment.loanAccount__requestor__fName}} {{payment.loanAccount__requestor__lName}}</td>
                        <td>{{payment.loanAccount__desiredAmount}}</td>
                        <td>{{payment.gcount}}</td>
                        <td>
                            {{payment.loanAccount__desiredAmount|sub:payment.gcount}}
                        </td>
                    {% endif %}
                </tr>
                </tbody>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

{% endblock %}